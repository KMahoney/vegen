(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const t of o)if(t.type==="childList")for(const d of t.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&s(d)}).observe(document,{childList:!0,subtree:!0});function a(o){const t={};return o.integrity&&(t.integrity=o.integrity),o.referrerPolicy&&(t.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?t.credentials="include":o.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function s(o){if(o.ep)return;o.ep=!0;const t=a(o);fetch(o.href,t)}})();function c(e,i={},a=[],s={}){const o=document.createElement(e);return Object.assign(o,i),Object.assign(o.dataset,s),o.append(...a),o}const f=e=>document.createTextNode(e);function N(e){return e.toString()}function H(e,i,a){return e[i]??a}function w({anchor:e,prevStates:i,nextInputs:a,subView:s}){const o=e.parentNode;let t=i.slice();for(;t.length>a.length;){const d=t.pop();o.removeChild(d.root)}for(let d=0;d<Math.min(t.length,a.length);d++)t[d].update(a[d]);for(let d=t.length;d<a.length;d++){const m=s(a[d]);o.insertBefore(m.root,e),t.push(m)}return t}function C(e,i){let a,s;return s=i(t=>{s=t(s),a.update(s)}),a=e(s),a.root}function L(e){const i=n=>{const r=f(n.ci.name),u=f(N(n.ci.qty)),g=f(n.currency(n.ci.lineTotal)),l=c("div",{className:"flex justify-between py-1 px-0.5 border-b border-dashed border-gray-300 text-sm"},[r,f(" × "),u,f(" — "),g],{testid:`item-${n.ci.name}`}),b=l;let x=n;return{root:b,update(y){(y.ci.lineTotal!==x.ci.lineTotal||y.currency!==x.currency)&&(g.textContent=y.currency(y.ci.lineTotal)),y.ci.name!==x.ci.name&&(r.textContent=y.ci.name,l.dataset.testid=`item-${y.ci.name}`),y.ci.qty!==x.ci.qty&&(u.textContent=N(y.ci.qty)),x=y}}},a=document.createComment("for-loop-0"),s=[];let o=[];for(const n of e.cart.getItems(e.categories,e.cart.items)){const r=i({...e,ci:n});s.push(r.root),o.push(r)}s.push(a);const t=f(N(e.cart.totalQty(e.cart.items))),d=f(e.currency(e.cart.subtotal(e.categories,e.cart.items))),m=f(e.currency(e.cart.grandTotal(e.categories,e.cart.items))),v=c("div",{className:"bg-white rounded-lg p-3 my-2 shadow-md"},[c("h2",{className:"text-xl font-semibold mb-4 text-blue-900"},[f("Cart")]),c("div",{className:"flex flex-col gap-3"},[...s],{testid:"cart-items"}),c("div",{className:"grid gap-1 items-baseline py-4 px-4 bg-gray-200 rounded-md mt-3"},[c("div",{className:"text-gray-700"},[f("Items")]),c("div",{className:"text-right font-semibold tabular-nums"},[t],{testid:"total-qty"}),c("div",{className:"text-gray-700"},[f("Subtotal")]),c("div",{className:"text-right font-semibold tabular-nums"},[d],{testid:"subtotal-amount"})]),c("div",{className:"bg-blue-100 rounded-md p-3 mt-3 text-center font-bold text-blue-900"},[f("Grand Total: "),m],{testid:"grand-total"})],{testid:"cart-section"});let h=e;return{root:v,update(n){(n.cart.grandTotal!==h.cart.grandTotal||n.cart.items!==h.cart.items||n.categories!==h.categories||n.currency!==h.currency)&&(m.textContent=n.currency(n.cart.grandTotal(n.categories,n.cart.items))),(n.cart.items!==h.cart.items||n.cart.subtotal!==h.cart.subtotal||n.categories!==h.categories||n.currency!==h.currency)&&(d.textContent=n.currency(n.cart.subtotal(n.categories,n.cart.items))),(n.cart.items!==h.cart.items||n.cart.totalQty!==h.cart.totalQty)&&(t.textContent=N(n.cart.totalQty(n.cart.items))),o=w({anchor:a,prevStates:o,nextInputs:n.cart.getItems(n.categories,n.cart.items).map(r=>({...n,ci:r})),subView:i}),h=n}}}function M(e){const i=d=>{const m=l=>{const b=f(l.item.name),x=f(l.currency(l.item.price)),y=c("button",{className:"w-10 py-2",onclick:l.cart.increment(l.item.id),title:"Add"},[f("+")],{testid:`add-${l.item.name}`}),S=c("button",{className:"w-10 py-2",onclick:l.cart.decrement(l.item.id),title:"Remove"},[f("-")],{testid:`remove-${l.item.name}`}),I=f(N(H(l.cart.items,l.item.id,0))),A=c("div",{className:"bg-white rounded-md p-3 transition-all duration-200 hover:shadow-lg hover:-translate-y-0.5 shadow-sm"},[c("div",{className:"flex flex-col gap-3"},[c("div",{className:"flex items-center justify-between gap-2"},[c("div",{className:"font-semibold"},[b]),c("div",{className:"bg-blue-600 text-white rounded-full px-2 py-1 text-xs font-semibold"},[x])]),c("div",{className:"flex items-center justify-between gap-2"},[c("div",{className:"text-center"},[y,S]),c("div",{className:"bg-gray-50 border border-dashed border-gray-300 rounded-full px-2 py-1 font-semibold text-sm flex items-center"},[f("Qty: "),I])])])]);let T=l;return{root:A,update(p){(p.cart.decrement!==T.cart.decrement||p.item.id!==T.item.id)&&(S.onclick=p.cart.decrement(p.item.id)),(p.cart.increment!==T.cart.increment||p.item.id!==T.item.id)&&(y.onclick=p.cart.increment(p.item.id)),(p.cart.items!==T.cart.items||p.item.id!==T.item.id)&&(I.textContent=N(H(p.cart.items,p.item.id,0))),(p.currency!==T.currency||p.item.price!==T.item.price)&&(x.textContent=p.currency(p.item.price)),p.item.name!==T.item.name&&(b.textContent=p.item.name,y.dataset.testid=`add-${p.item.name}`,S.dataset.testid=`remove-${p.item.name}`),T=p}}},v=document.createComment("for-loop-0"),h=[];let n=[];for(const l of d.cat.items){const b=m({...d,item:l});h.push(b.root),n.push(b)}h.push(v);const r=f(d.cat.name),u=c("div",{className:"bg-gray-50 rounded-md p-3 border-l-4 border-blue-600"},[c("h3",{className:"text-lg font-medium mb-3 mt-0"},[r]),c("div",{className:"flex flex-col gap-3"},[...h])]);let g=d;return{root:u,update(l){l.cat.name!==g.cat.name&&(r.textContent=l.cat.name),n=w({anchor:v,prevStates:n,nextInputs:l.cat.items.map(b=>({...l,item:b})),subView:m}),g=l}}},a=document.createComment("for-loop-0"),s=[];let o=[];for(const d of e.categories){const m=i({...e,cat:d});s.push(m.root),o.push(m)}return s.push(a),{root:c("div",{className:"rounded-lg p-4 shadow-md"},[c("h2",{className:"text-xl font-semibold mb-4 text-blue-900"},[f("Menu")]),c("div",{className:"flex flex-col gap-3"},[...s])],{testid:"menu-section"}),update(d){o=w({anchor:a,prevStates:o,nextInputs:d.categories.map(m=>({...d,cat:m})),subView:i})}}}function q(e){const i=r=>({root:f(`
      `),update(g){}}),a=r=>{const u=c("input",{className:"border border-gray-300 rounded-md px-3 py-2 w-full",oninput:r.order.updateTable,placeholder:"Table Number",value:r.dinein.table},[],{testid:"table-input"}),g=c("div",{className:"mb-4"},[u]);let l=r;return{root:g,update(b){b.dinein.table!==l.dinein.table&&(u.value=b.dinein.table),b.order.updateTable!==l.order.updateTable&&(u.oninput=b.order.updateTable),l=b}}},s=r=>{const u=c("input",{className:"border border-gray-300 rounded-md px-3 py-2 w-full",oninput:r.order.updateAddress,placeholder:"Delivery Address",value:r.delivery.address},[],{testid:"address-input"}),g=c("div",{className:"mb-4"},[u]);let l=r;return{root:g,update(b){b.delivery.address!==l.delivery.address&&(u.value=b.delivery.address),b.order.updateAddress!==l.order.updateAddress&&(u.oninput=b.order.updateAddress),l=b}}};let o;const t=(()=>{switch(e.order.details.type){case"pickup":{({...e,pickup:e.order.details});const u=i();return o=u,u.root}case"dinein":{const u={...e,dinein:e.order.details},g=a(u);return o=g,g.root}case"delivery":{const u={...e,delivery:e.order.details},g=s(u);return o=g,g.root}default:{const u={root:document.createComment("switch-empty"),update:g=>{}};return o=u,u.root}}})(),d=c("button",{className:"px-2 py-2",onclick:e.order.selectOrder("pickup")},[f("Pick Up")],{testid:"pickup-btn"}),m=c("button",{className:"px-2 py-2",onclick:e.order.selectOrder("dinein")},[f("Dine In")],{testid:"dinein-btn"}),v=c("button",{className:"px-2 py-2",onclick:e.order.selectOrder("delivery")},[f("Delivery")],{testid:"delivery-btn"}),h=c("div",{className:"bg-white rounded-lg p-4 my-3 shadow-md"},[c("h2",{className:"text-xl font-semibold mb-4 text-blue-900"},[f("Order")]),c("div",{className:"mb-4 flex gap-1"},[d,m,v]),t]);let n=e;return{root:h,update(r){r.order.selectOrder!==n.order.selectOrder&&(d.onclick=r.order.selectOrder("pickup"),m.onclick=r.order.selectOrder("dinein"),v.onclick=r.order.selectOrder("delivery"));const u=r.order.details.type,g=n.order.details.type;if(u!==g){let l,b;switch(u){case"pickup":{({...r,pickup:r.order.details},l=i()),b=l.root;break}case"dinein":{const x={...r,dinein:r.order.details};l=a(x),b=l.root;break}case"delivery":{const x={...r,delivery:r.order.details};l=s(x),b=l.root;break}default:l={root:document.createComment("switch-empty"),update:x=>{}},b=l.root}o.root.replaceWith(b),o=l}else switch(u){case"pickup":{const l={...r,pickup:r.order.details};o.update(l);break}case"dinein":{const l={...r,dinein:r.order.details};o.update(l);break}case"delivery":{const l={...r,delivery:r.order.details};o.update(l);break}}n=r}}}function K(e){const i=M({cart:e.cart,categories:e.categories,currency:e.currency}),a=q({order:e.order}),s=L({cart:e.cart,categories:e.categories,currency:e.currency});return{root:c("div",{},[c("h1",{className:"p-4"},[f("Cafe Example")]),c("div",{className:"flex gap-4 p-4"},[c("div",{className:"grow"},[i.root]),c("div",{className:"flex flex-col gap-4"},[c("div",{},[a.root]),c("div",{},[s.root])])])],{testid:"cafe-app"}),update(t){i.update({cart:t.cart,categories:t.categories,currency:t.currency}),a.update({order:t.order}),s.update({cart:t.cart,categories:t.categories,currency:t.currency})}}}function Q(e){const i=f(N(e.count)),a=c("button",{className:"px-8 py-4",onclick:e.clickHandler},[f("Clicked "),i,f(" times")],{testid:"counter-button"}),s=c("div",{},[c("h1",{className:"p-4"},[f("Counter Example")]),c("div",{className:"p-4"},[a])],{testid:"counter-app"});let o=e;return{root:s,update(t){t.clickHandler!==o.clickHandler&&(a.onclick=t.clickHandler),t.count!==o.count&&(i.textContent=N(t.count)),o=t}}}function $(e){let i=e.component({});const a=c("button",{className:"w-30 py-2",onclick:e.setExample("cafe")},[f("Cafe")]),s=c("button",{className:"w-30 py-2",onclick:e.setExample("todo")},[f("Todo")]),o=c("button",{className:"w-30 py-2",onclick:e.setExample("counter")},[f("Counter")]),t=c("div",{},[c("div",{className:"flex gap-2 bg-blue-50 p-4"},[a,s,o]),i.root]);let d=e;return{root:t,update(m){if(m.setExample!==d.setExample&&(a.onclick=m.setExample("cafe"),s.onclick=m.setExample("todo"),o.onclick=m.setExample("counter")),m.component!==d.component){const v=m.component({});i.root.replaceWith(v.root),i=v}else i.update({});d=m}}}function B(e){const i=r=>{const u=c("input",{checked:r.todo.completed,className:"w-5 h-5 text-purple-400 accent-purple-400 cursor-pointer",onchange:r.toggleHandler(r.todo.id),type:"checkbox"},[]),g=f(r.todo.text),l=c("button",{className:"px-4 py-2 bg-red-500 text-white rounded-lg font-medium cursor-pointer transition-all duration-300 hover:bg-red-600 hover:scale-105 active:scale-95",onclick:r.deleteHandler(r.todo.id),type:"button"},[f("Delete")]),b=c("li",{className:"flex items-center gap-3 px-5 py-4 mb-3 bg-white border-2 border-gray-100 rounded-xl transition-all duration-300 hover:shadow-md hover:-translate-y-0.5 animate-[slideIn_0.4s_ease-in]"},[u,c("span",{className:"flex-1 text-base font-medium"},[g]),l]);let x=r;return{root:b,update(y){(y.deleteHandler!==x.deleteHandler||y.todo.id!==x.todo.id)&&(l.onclick=y.deleteHandler(y.todo.id)),y.todo.completed!==x.todo.completed&&(u.checked=y.todo.completed),(y.todo.id!==x.todo.id||y.toggleHandler!==x.toggleHandler)&&(u.onchange=y.toggleHandler(y.todo.id)),y.todo.text!==x.todo.text&&(g.textContent=y.todo.text),x=y}}},a=document.createComment("for-loop-0"),s=[];let o=[];for(const r of e.todos){const u=i({...e,todo:r});s.push(u.root),o.push(u)}s.push(a);const t=c("input",{className:"grow",oninput:e.updateNewTodoText,onkeypress:e.handleKeyPress,placeholder:"Add a new todo...",type:"text",value:e.newTodoText},[],{testid:"todo-input"}),d=c("button",{className:"px-8 py-4",onclick:e.addTodoHandler},[f("Add Todo")],{testid:"add-todo-btn"}),m=f(N(e.totalCount(e.todos))),v=f(N(e.completedCount(e.todos))),h=c("div",{},[c("h1",{className:"p-4"},[f("Todo Example")]),c("div",{className:"flex gap-3 mb-8 p-4 items-center"},[t,d]),c("div",{className:"mb-8 p-4"},[c("ul",{className:"p-0 m-0"},[...s],{testid:"todo-list"})]),c("div",{className:"p-4"},[c("div",{className:"flex justify-between gap-4 px-5 py-5 bg-gradient-to-r from-gray-100 to-gray-200 rounded-xl border-2 border-gray-200 min-h-5"},[c("p",{className:"m-0 text-base font-semibold text-gray-700"},[f("Total todos: "),m],{testid:"total-count"}),c("p",{className:"m-0 text-base font-semibold text-gray-700"},[f("Completed: "),v],{testid:"completed-count"})])])],{testid:"todo-app"});let n=e;return{root:h,update(r){r.addTodoHandler!==n.addTodoHandler&&(d.onclick=r.addTodoHandler),(r.completedCount!==n.completedCount||r.todos!==n.todos)&&(v.textContent=N(r.completedCount(r.todos))),r.handleKeyPress!==n.handleKeyPress&&(t.onkeypress=r.handleKeyPress),r.newTodoText!==n.newTodoText&&(t.value=r.newTodoText),(r.todos!==n.todos||r.totalCount!==n.totalCount)&&(m.textContent=N(r.totalCount(r.todos))),r.updateNewTodoText!==n.updateNewTodoText&&(t.oninput=r.updateNewTodoText),o=w({anchor:a,prevStates:o,nextInputs:r.todos.map(u=>({...r,todo:u})),subView:i}),n=r}}}const _=[{name:"Coffee",items:[{id:"espresso",name:"Espresso",price:300},{id:"latte",name:"Latte",price:350}]},{name:"Tea",items:[{id:"black-tea",name:"Black Tea",price:250},{id:"green-tea",name:"Green Tea",price:280}]}];function O(e){return e.reduce((i,a)=>i+a,0)}function j(){return C(K,e=>({categories:_,cart:{items:{},decrement:a=>()=>{e(s=>(s.cart.items[a]??0)<=0?s:{...s,cart:{...s.cart,items:{...s.cart.items,[a]:(s.cart.items[a]??0)-1}}})},increment:a=>()=>{e(s=>({...s,cart:{...s.cart,items:{...s.cart.items,[a]:(s.cart.items[a]??0)+1}}}))},getItems:function(a,s){const o=Object.fromEntries(a.flatMap(t=>t.items).map(t=>[t.id,[t.name,t.price]]));return Object.entries(s).map(([t,d])=>{const[m,v]=o[t];return{qty:d,lineTotal:d*v,name:m}}).filter(t=>t.qty>0)},grandTotal:function(a,s){const o=Object.fromEntries(a.flatMap(t=>t.items).map(t=>[t.id,t.price]));return O(Object.entries(s).map(([t,d])=>{const m=o[t];return d*m}))},subtotal:function(a,s){const o=Object.fromEntries(a.flatMap(t=>t.items).map(t=>[t.id,t.price]));return O(Object.entries(s).map(([t,d])=>{const m=o[t];return d*m}))},totalQty:function(a){return O(Object.values(a))}},currency:function(a){return(a/100).toLocaleString("en-GB",{style:"currency",currency:"GBP"})},order:{details:{type:"pickup"},selectOrder:a=>()=>{e(s=>{let o;switch(a){case"dinein":o={type:"dinein",table:""};break;case"delivery":o={type:"delivery",address:""};break;case"pickup":o={type:"pickup"};break;default:o=s.order.details;break}return{...s,order:{...s.order,details:o}}})},updateTable:a=>{e(s=>({...s,order:{...s.order,details:{type:"dinein",table:a.target.value}}}))},updateAddress:a=>{e(s=>({...s,order:{...s.order,details:{type:"delivery",address:a.target.value}}}))}}}))}function P(){return C(Q,e=>({clickHandler:()=>{e(i=>({...i,count:i.count+1}))},count:0}))}function V(){let e=1;return C(B,i=>{const a=()=>{i(o=>{const t=o.newTodoText.trim();if(!t)return o;const d={id:String(e++),text:t,completed:!1},m=[...o.todos,d];return{...o,todos:m,newTodoText:""}})};return{todos:[],newTodoText:"",totalCount:o=>o.length,completedCount:o=>o.filter(t=>t.completed).length,addTodoHandler:()=>{a()},updateNewTodoText:o=>{const t=o.target;i(d=>({...d,newTodoText:t.value}))},handleKeyPress:o=>{o.key==="Enter"&&a()},toggleHandler:o=>()=>{i(t=>{const d=t.todos.map(m=>m.id===o?{...m,completed:!m.completed}:m);return{...t,todos:d}})},deleteHandler:o=>()=>{i(t=>{const d=t.todos.filter(m=>m.id!==o);return{...t,todos:d}})}}})}function E(e){return()=>({root:e(),update:a=>{}})}const k={cafe:E(j),counter:E(P),todo:E(V)},D=k[document.location.hash.slice(1)]??k.cafe;function G(){return C($,e=>({runCafe:j,runCounter:P,runTodo:V,component:D,setExample:i=>()=>{document.location.hash=i,e(a=>({...a,component:k[i]??k.cafe}))}}))}document.getElementById("app").append(G());
